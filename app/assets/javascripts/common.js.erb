$.extend($.expr[':'], {
  'containsi': function(elem, i, match, array)
  {
    return (elem.textContent || elem.innerText || '').toLowerCase()
    .indexOf((match[3] || "").toLowerCase()) >= 0;
  }
});



$(document).on('click', '.fa-bars', function(){
  $('.resp-menu').toggle('slide','slow', function(){
    $('.on-icon').toggleClass('hidden');
  });
  $('.fixed .fa').toggleClass('fa-bars fa-times', 'slow');
  $('.fixed').toggleClass('bg-brand', 'slow');
});

$(document).on('click', '#admin-collapse', function(){
  $('.left-menu').toggle('slide', 'slow', function(){
    $(this).toggleClass('toggled');
  });
});

$(document).on('click', '.fixed .fa-times', function(){
  $('.resp-menu').toggle('slide','slow', function(){
    $('.on-icon').toggleClass('hidden');
  });
  $('.fixed .fa').toggleClass('fa-bars fa-times', 'slow');
  $('.fixed').toggleClass('bg-brand', 'slow');
});

$(document).on('click','.modal-body a', function(){
  $('.modal-body').html('<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>');
});


$(document).on('click','.resp-menu  .dropdown li', function(){
  $('.dropdown-menus', this).toggle();
});


$(document).ready(function(){

  $('input[name="search"]').on('keyup', function(e){
    var search = $(this).val();
    var key = event.which || event.keyCode || event.charCode;
    if(search == ''){
      $('.modal div').show();
    }else{
      $('.modal').find('.as_btn:not(:containsi("'+search+'"))').closest('div').hide();
      $('.modal').find('.as_btn:containsi("'+search+'")').closest('div').show();
    }
  });
  $(document).on('click', '#clear-search', function(){
    $('input[name="search"]').val('');
    $('.modal div').show();
  });

  $('#subposition_quantity').keypress(function (e) {
    if (e.which == 13) {
      $(this).blur();
      $(this).closest('form').submit();
      return false;
    }
  });
  $('[data-mask]').each(function(index, value){
    element = $(value)
    element.mask($(value).data('mask'), {placeholder: '-'})
  });

  $('.clockpicker').clockpicker(
    {'default': 'now',
      autoclose: true,
      donetext: 'Готово!'}
    );
});
